/*SEÇÃO 13 -> PROGRAMANDO EM MYSQL*/

/*; -> DELIMITER:
	- SEPARA OS BLOCOS DE COMANDO;
	- STATUS;
	- MUDANDO O DELIMITADOR:
*/

DELIMITER $


/*CRIANDO PROCEDIMENTOS NO BANCO:
	- STORED PROCEDURES:
		- BLOCOS NOMEADOS;
		- MUDAR O DELIMITER;

*/

SELECT 'EDAN'; /*BLOCO ANÔNIMO*/
DELIMITER $

CREATE PROCEDURE NOME()
BEGIN

	QUALQUER PROGRAMACAO;

END
$


CREATE PROCEDURE NOME_EMPRESA()
BEGIN

	SELECT 'UNIVERSIDADE DOS DADOS' AS EMPRESA;

END
$

/*CHAMANDO UMA PROCEDURE*/

CALL NOME_EMPRESA()$



/*PROCEDURES COM PARÂMETRO*/
SELECT 10 + 10 AS CONTA$


CREATE PROCEDURE CONTA()
BEGIN

	SELECT 10 + 10 AS CONTA;

END
$


DROP PROCEDURE CONTA$


CREATE PROCEDURE CONTA(NUM1 INT, NUM2 INT)
BEGIN

	SELECT NUM1 + NUM2 AS CONTA;

END
$


CALL CONTA(2, 3)$



/*PROCEDURES NO MUNDO REAL:
	- A REGRA DE NEGÓCIO PODE FICAR NA CAMADA DE SOFTWARE OU NO PRÓPRIO BANCO;
	- CASO FIQUE NA CAMADA DE SOFTWARE, ELA ELEVA O NÍVEL DE PROCESSAMENTO DA LINGUAGEM USADA, MAS EM CONTRAPARTIDA FACILITA A MIGRAÇÃO PARA OUTRO BANCO.
	- CASO FIQUE NO BANCO, MELHORA O DESEMPENHO, MAS PODE FICAR EXPOSTA A INJECTIONS. ALIÁS, ISSO TAMBÉM FACILITA A MUDANÇA DA LINGUAGEM DE PROGRAMAÇÃO.
	- TUDO DEPENDE DA REGRA DE NEGÓCIO E DA ABORDAGEM ADOTADA PELA EMPRESA.


	- CAMADAS:
		- VIEW -> FRAMEWORK, HTML, CSS, ETC.;
		- CONTROLLER -> JAVA, PYTHON, C#, ETC.;
		- MODEL -> ORACLE, MYSQL, SQL SERVER, ETC.;
*/


/*PROCEDURES COM QUERY: 
	- VAMOS CRIAR A RN DIRETAMENTE NO BANCO DE DADOS, PULANDO A CAMADA DE CONTROLLER.
*/

CREATE DATABASE CURSOS;
USE CURSOS;
CREATE TABLE CURSOS(
	IDCURSO INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR(30) NOT NULL,
	HORAS INT(3) NOT NULL,
	VALOR FLOAT(10,2) NOT NULL
);

INSERT INTO CURSOS VALUES(NULL, 'JAVA', 30, 500.00);
INSERT INTO CURSOS VALUES(NULL, 'FUNDAMENTOS DE BANCOS DE DADOS', 40, 700.00);

DELIMITER $
STATUS


CREATE PROCEDURE CAD_CURSO(P_NOME VARCHAR(30),
                           P_HORAS INT(3),
                           P_PRECO FLOAT(10,2))
BEGIN
	
	INSERT INTO CURSOS VALUES(NULL, P_NOME, P_HORAS, P_PRECO);

END
$

DELIMITER ;


CALL CAD_CURSO('BI SQL SERVER', 60, 1200.00);
CALL CAD_CURSO('HTML, CSS E JS', 40, 650.00);


DELIMITER $

CREATE PROCEDURE CONSULTA_CURSOS()
BEGIN

	SELECT * FROM CURSOS;

END
$

DELIMITER ;
CALL CONSULTA_CURSOS;


/*MONSTER MASH*/